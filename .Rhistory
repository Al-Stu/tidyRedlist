tidyCriteria <- function(redCriteria){
redCriteria$internalTaxonId <- as.character(redCriteria$internalTaxonId)
to_columns <- RL.criteriatocolumns(redCriteria$redlistCriteria,'[+]','^.','[0-9].*$')
to_columns_pivot <-  RL.pivottocolumns(redCriteria,to_columns)
l2_to_columns <- RL.criteriatocolumnsl2(input = to_columns_pivot$criterion,pattern = '')
l2_to_columns_pivot <-  RL.pivottocolumns(to_columns_pivot,l2_to_columns)
l3_to_columns <- splittocolumns(l2_to_columns_pivot$criterion,pattern = '') %>%
dplyr::bind_cols(l2_to_columns_pivot[,1]) %>%
dplyr::right_join(redCriteria[,c(1,2)]) %>%
dplyr::select(`internalTaxonId`,`scientificName`, everything()) %>%
dplyr::rename(level1=`V1`,
level2=`V2`,
level3=`V3`) %>%
dplyr::filter(!is.na(`level1`))
return(l3_to_columns)
}
devtools::document()
devtools::document()
tidyCriteria <- function(redCriteria){
redCriteria$internalTaxonId <- as.character(redCriteria$internalTaxonId)
to_columns <- RL.criteriatocolumns(redCriteria$redlistCriteria,'[+]','^.','[0-9].*$')
to_columns_pivot <-  RL.pivottocolumns(redCriteria,to_columns)
l2_to_columns <- RL.criteriatocolumnsl2(input = to_columns_pivot$criterion,pattern = '')
l2_to_columns_pivot <-  RL.pivottocolumns(to_columns_pivot,l2_to_columns)
l3_to_columns <- splittocolumns(l2_to_columns_pivot$criterion,pattern = '') %>%
dplyr::bind_cols(l2_to_columns_pivot[,1]) %>%
dplyr::right_join(redCriteria[,c(1,2)]) %>%
dplyr::select(`internalTaxonId`,`scientificName`, everything()) %>%
dplyr::rename(level1=`V1`,
level2=`V2`,
level3=`V3`) %>%
dplyr::filter(!is.na(`level1`))
return(l3_to_columns)
}
devtools::document()
devtools::document()
